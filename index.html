<!DOCTYPE html>  
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Math Sprint â€” Head-to-Head</title>
<style>
  :root{--bg:#0f1220;--panel:#161a2e;--ink:#e9ecf1;--muted:#aab3c5;--good:#38d39f;--bad:#ff6b6b;--warn:#ffb020;--chip:#232843}
  *{box-sizing:border-box} html,body{height:100%}
  body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;background:radial-gradient(1200px 800px at 10% -10%,#1b2142 0%,var(--bg) 55%);color:var(--ink);display:grid;place-items:start stretch}
  .wrap {width: 100%; margin: 28px 0 56px;}

  header{display:grid;gap:12px;grid-template-columns:1fr auto;align-items:start;margin-bottom:16px}
  h1{font-weight:800;margin:0;letter-spacing:.2px;font-size:clamp(20px,2.8vw,28px)}

  .controls{display:grid;gap:10px;padding:14px;background:color-mix(in oklab,var(--panel),#000 6%);border:1px solid #262b4a;border-radius:14px;grid-template-columns:repeat(8,minmax(0,1fr));align-items:end}
  .group{display:grid;gap:6px} label{font-size:12px;color:var(--muted);letter-spacing:.2px}
  select,input[type="range"],input[type="text"]{width:100%;padding:10px 12px;border-radius:10px;border:1px solid #2c335a;background:#0e1330;color:var(--ink);outline:none}
  .range-row{display:grid;grid-template-columns:1fr auto;align-items:center;gap:8px}
  .chip{background:var(--chip);border:1px solid #2b3155;border-radius:999px;padding:6px 10px;font-size:12px;color:var(--muted)}

  .btn{appearance:none;border:1px solid #2c335a;background:linear-gradient(180deg,#1e2550,#141a3b);color:#fff;padding:10px 14px;border-radius:12px;cursor:pointer;font-weight:700;letter-spacing:.2px;transition:transform .03s ease,filter .15s ease,border-color .15s ease}
  .btn:hover{filter:brightness(1.08);border-color:#3a4381} .btn:active{transform:translateY(1px) scale(.997)}
  .btn.ghost{background:#0e1330;color:var(--muted)} .btn.good{background:linear-gradient(180deg,#16553f,#103c2d);border-color:#1f6b4f;color:#d3ffe9}

  .grid {display: grid; grid-template-columns: minmax(0, 3fr) minmax(0, 2fr); gap: 16px; align-items: stretch; }
  .card{background:var(--panel);border:1px solid #262b4a;border-radius:16px;padding:16px;box-shadow:0 10px 30px rgba(0,0,0,.25)}
  .problem{position:relative;display:grid;justify-items:center;align-content:center;gap:16px;background:radial-gradient(600px 340px at 50% -30%,#1a2150 0%,#121633 60%,#0f1329 100%);border-radius:12px;border:1px solid #262b4a;padding:16px}
 .formula {
  font-size:64px;font-weight:800;letter-spacing:1px;margin-top:40px;margin-left:40px;}


  .timer-mini{position:absolute;top:12px;left:12px;width:88px;height:88px;display:grid;place-items:center;background:#0e1330;border:1px solid #2b3155;border-radius:12px;font-weight:800;letter-spacing:.5px;font-size:20px;box-shadow:0 6px 20px rgba(0,0,0,.35);}

.answer-rows {display:flex;flex-direction:column;justify-content:flex-end; height:100%;}

  .row{display:grid;grid-template-columns:auto 1fr auto;gap:10px;align-items:center}
  .row input{padding:12px 14px;border-radius:12px;border:1px solid #2c335a;outline:none;background:#0e1330;color:#fff;font-size:clamp(18px,2.2vw,22px);text-align:center;letter-spacing:.5px}
  .p1{border-left:4px solid #6bd3ff;padding-left:8px;border-radius:10px}
  .p2{border-left:4px solid #ffb86b;padding-left:8px;border-radius:10px}
  .avatar{width:36px;height:36px;border-radius:50%;object-fit:cover;border:1px solid #2b3155}
  .hidden{display:none !important}

  .feedback{height:28px;font-weight:700;letter-spacing:.3px}
  .feedback.ok{color:var(--good)} .feedback.no{color:var(--bad)}

  .stats{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-top:12px}
  .stat{background:#0e1330;border:1px solid #2b3155;border-radius:12px;padding:10px 12px;display:grid;gap:4px} .stat b{font-size:22px}

  .fx-overlay{position:fixed;inset:0;display:grid;place-items:center;pointer-events:none;opacity:0;transition:opacity .25s ease;z-index:999}
  .fx-overlay.show{opacity:1}
  .fx-overlay img,
  .fx-overlay video{max-width:min(60vmin,520px);max-height:70vh;border-radius:12px;box-shadow:0 20px 60px rgba(0,0,0,.55);border:2px solid #2b3155;background:#000}

  .turn-overlay{position:fixed;inset:0;background:rgba(5,8,20,.88);backdrop-filter:blur(6px);display:grid;place-items:center;z-index:1000;opacity:0;pointer-events:none;transition:opacity .2s ease}
  .turn-overlay.show{opacity:1;pointer-events:auto}
  .turn-card{background:var(--panel);border:1px solid #2b3155;border-radius:18px;padding:28px;display:grid;gap:14px;place-items:center;box-shadow:0 20px 60px rgba(0,0,0,.45)}
  .turn-card h2{margin:0;font-size:clamp(20px,3.2vw,28px)}
  .turn-avatar{width:min(22vmin,140px);height:min(22vmin,140px);border-radius:50%;object-fit:cover;border:2px solid #2b3155}
</style>
</head>
<body>
  <!-- overlays -->
  <div id="fxGood" class="fx-overlay">
    <img id="fxGoodImg" alt="Correct">
    <video id="fxGoodVid" playsinline></video>
  </div>
  <div id="fxBad" class="fx-overlay">
    <img id="fxBadImg" alt="Incorrect">
    <video id="fxBadVid" playsinline></video>
  </div>

<script>
(function(){
  const STILL_MIN_MS = 1600;
  var fxGood=document.getElementById('fxGood'),
      fxBad=document.getElementById('fxBad'),
      fxGoodImg=document.getElementById('fxGoodImg'),
      fxBadImg=document.getElementById('fxBadImg'),
      fxGoodVid=document.getElementById('fxGoodVid'),
      fxBadVid=document.getElementById('fxBadVid');

  function isGif(src){ return /\.gif$/i.test(src); }
  function isMp4(src){ return /\.mp4$/i.test(src); }

  function scheduleHide(el,ms){ if(el._ht) clearTimeout(el._ht); el._ht=setTimeout(()=>{el.classList.remove('show');},ms); }

  function flash(el,list,hold){
    hold=hold||600;
    var pick=(list&&list.length)?list[Math.floor(Math.random()*list.length)]:"";
    var isGood=(el===fxGood);
    var imgEl=isGood?fxGoodImg:fxBadImg;
    var vidEl=isGood?fxGoodVid:fxBadVid;

    // reset
    imgEl.style.display="none"; vidEl.style.display="none"; vidEl.pause(); vidEl.src="";

    if(isMp4(pick)){
      vidEl.src=pick; vidEl.style.display="block"; el.classList.add('show');
      vidEl.currentTime=0; vidEl.play().catch(()=>{});
      vidEl.onended=()=>{el.classList.remove('show');};
      return;
    }

    imgEl.src=pick; imgEl.style.display="block"; el.classList.add('show');
    if(!isGif(pick)){ scheduleHide(el,Math.max(hold,STILL_MIN_MS)); }
    else{ scheduleHide(el,2000); } // simple default for gifs
  }

  // Example test
  window.flashGood=()=>flash(fxGood,["images/test.mp4","images/Correct1.webp"]);
  window.flashBad =()=>flash(fxBad, ["images/Wrong1.png","images/testbad.mp4"]);
})();
</script>
</body>
</html>
